# v2.2 Probability ç®—æ³•é‡æ„å®Œæˆ

**æ›´æ–°æ—¥æœŸ**: 2026-01-07
**ç‰ˆæœ¬**: v2.1 â†’ v2.2

---

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. é‡æ„ Probability è®¡ç®—ç®—æ³•
- âœ… æ›´ä¿å®ˆçš„ Sigmoid å‡½æ•°ï¼ˆk=0.2, x0=15ï¼‰
- âœ… å¼•å…¥"æœ¨æ¡¶æ•ˆåº”"ï¼ˆä½¿ç”¨ min() å‡½æ•°ï¼‰
- âœ… ä¸¥æ ¼çš„æƒ©ç½šæœºåˆ¶
- âœ… æ¦‚ç‡ä¸Šé™è®¾ä¸º 0.95

### 2. æ ¸å¿ƒæ”¹è¿›

#### åŸºç¡€æ¦‚ç‡ (Base_Prob)
- **æ—§**: RA=10% â†’ 0.82 (è¿‡äºä¹è§‚)
- **æ–°**: RA=10% â†’ 0.27 (æ›´ä¿å®ˆ) âœ…

#### æƒ©ç½šæœºåˆ¶
- **å®¿ä¸»ä¸åŒ¹é…**: 0.93 â†’ 0.50 (ä¸¥é‡æƒ©ç½š -50%)
- **é€šç”¨è®°å½•**: 0.95 â†’ 0.75 (æ˜¾è‘—æƒ©ç½š -25%)
- **ä½è´¨é‡è¯æ®**: 0.93 â†’ 0.60 (æ˜¾è‘—æƒ©ç½š -40%)
- **å±çº§åŒ¹é…**: 1.02 â†’ 0.70 (æ˜¾è‘—æƒ©ç½š -30%)

#### æœ¨æ¡¶æ•ˆåº”
```python
# æ—§: æ‰€æœ‰å› å­ç›¸ä¹˜
probability = base_prob Ã— conf Ã— host Ã— evidence Ã— taxa

# æ–°: ä½¿ç”¨ min() å®ç°ç“¶é¢ˆé™åˆ¶
bottleneck = min(conf, host, evidence)
probability = base_prob Ã— bottleneck Ã— taxa
```

---

## ğŸ“Š æ•ˆæœå¯¹æ¯”

### æµ‹è¯•æ•°æ®
- è¾“å…¥: `tests/data/test_data.tsv`
- å®¿ä¸»: `Drosophila melanogaster`

### v2.1 ç»“æœ (æ—§ç®—æ³•)
```
Function                    Probability
other                       1.000  âŒ è¿‡é«˜
pesticide metabolization    0.973  âŒ è¿‡é«˜
pathogen resistance         0.867  âŒ è¿‡é«˜
```

### v2.2 ç»“æœ (æ–°ç®—æ³•)
```
Function                    Probability
other                       0.282  âœ… åˆç†
pesticide metabolization    0.237  âœ… åˆç†
pathogen resistance         0.212  âœ… åˆç†
```

**æ”¹è¿›**:
- âœ… æ¦‚ç‡æ™®éé™ä½åˆ°åˆç†èŒƒå›´ï¼ˆ0.1-0.3ï¼‰
- âœ… åŒºåˆ†åº¦æ˜¾è‘—æå‡
- âœ… ç¬¦åˆç”Ÿç‰©å­¦ç°å®ï¼ˆä¸€èˆ¬ä¸è¶…è¿‡ 80%ï¼‰
- âœ… é«˜æ½œåŠ›åŠŸèƒ½æ›´çªå‡º

---

## ğŸ¯ æ–°çš„æ¦‚ç‡ç­‰çº§

| æ¦‚ç‡èŒƒå›´ | ç­‰çº§ | é¢œè‰² | é¢„æœŸæ¯”ä¾‹ |
|---------|------|------|---------|
| 0.75-0.95 | æé«˜ | æ·±ç»¿è‰² | <5% |
| 0.60-0.74 | é«˜ | ç»¿è‰² | 5-10% |
| 0.40-0.59 | ä¸­ç­‰ | é»„è‰² | 15-25% |
| 0.20-0.39 | ä½ | æ©™è‰² | 40-50% |
| 0.00-0.19 | æä½ | ç°è‰² | 20-30% |

**è¾¾åˆ°é«˜æ¦‚ç‡ (>0.75) éœ€è¦åŒæ—¶æ»¡è¶³**:
1. RA% > 25%
2. ç§çº§åŒ¹é…
3. å®¿ä¸»ç‰©ç§çº§åŒ¹é…
4. Evidence Level 5
5. Taxa_Count â‰¥ 10

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### ç­›é€‰é«˜ç½®ä¿¡åº¦åŠŸèƒ½
```python
high_conf = df[
    (df['Probability'] >= 0.60) &
    (df['Final_Score_Sum'] > 200)
]
```

### ç­›é€‰éœ€è¦éªŒè¯çš„åŠŸèƒ½
```python
need_validation = df[
    (df['Probability'] >= 0.40) &
    (df['Probability'] < 0.60)
]
```

---

## ğŸ“š æ–‡æ¡£

**è¯¦ç»†æ–‡æ¡£**: `./logs/s16_predictor_v2.2_PROBABILITY_REFACTOR.md`

åŒ…å«:
- å®Œæ•´çš„ç®—æ³•æ¨å¯¼å’Œå¯¹æ¯”
- ç§‘å­¦ä¾æ®å’Œå‚è€ƒæ–‡çŒ®
- å‚æ•°è°ƒä¼˜æŒ‡å—
- ä½¿ç”¨ç¤ºä¾‹å’Œå¯è§†åŒ–å»ºè®®

---

## ğŸ”„ å‘åå…¼å®¹æ€§

### è¾“å‡ºæ ¼å¼
- âœ… å®Œå…¨å…¼å®¹ï¼Œä»… Probability æ•°å€¼å˜åŒ–

### é˜ˆå€¼è°ƒæ•´
- âš ï¸ éœ€è¦æ›´æ–°é˜ˆå€¼
- æ—§ç‰ˆ: >0.75 (é«˜)
- æ–°ç‰ˆ: >0.60 (é«˜), >0.40 (ä¸­ç­‰)

---

**ç‰ˆæœ¬**: v2.2
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•
**æœ€åæ›´æ–°**: 2026-01-07
